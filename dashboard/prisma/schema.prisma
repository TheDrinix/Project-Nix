// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Guild {
  id      String  @id
  name    String
  lobbies Lobby[]
}

model Lobby {
  id                        String                     @id
  entryPointId              String                     @unique
  isPrivate                 Boolean                    @default(false)
  waitingRoomId             String?                    @unique
  namingScheme              String
  allowPersonalizedNaming   Boolean                    @default(false)
  PersonalizedNamingSchemes PersonalizedNamingScheme[]
  protectedChannelIds       String[]
  guild                     Guild                      @relation(fields: [guildId], references: [id])
  guildId                   String

  @@index([entryPointId])
  @@index([waitingRoomId])
}

model PersonalizedNamingScheme {
  pattern  String
  memberId String
  lobby    Lobby  @relation(fields: [lobbyId], references: [id])
  lobbyId  String

  @@id([lobbyId, memberId])
}
